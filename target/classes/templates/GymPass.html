<!DOCTYPE html>
<html lang="pl" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="#{page.title}">Lista GymPass</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>

<div th:replace="~{fragments/header :: header}"></div>

<div class="container mt-4">
    <h1 th:text="#{page.title}">Lista GymPass</h1>

    <div class="mb-3" sec:authorize="hasRole('ADMIN')">
        <a th:href="@{/form}" class="btn btn-primary" th:text="#{page.add}">Dodaj nowy karnet</a>
    </div>

    <div th:if="${#lists.isEmpty(gympasses)}" class="alert alert-info">
        <p th:text="#{page.nodata}">Brak danych</p>
    </div>

    <div th:unless="${#lists.isEmpty(gympasses)}" class="table-responsive">
        <table class="table table-striped table-hover">
            <thead class="table-dark">
            <tr>
                <th th:text="#{table.id}">ID</th>
                <th th:text="#{table.owner}">Właściciel</th>
                <th th:text="#{table.type}">Typ</th>
                <th th:text="#{table.active}">Aktywny?</th>
                <th th:text="#{table.startdate}">Od</th>
                <th th:text="#{table.enddate}">Do</th>
                <th th:text="#{table.entries}">Pozostałe wejścia</th>
                <th th:text="#{table.price}">Cena</th>
                <th th:text="#{audit.createdBy}">Utworzone przez</th>
                <th th:text="#{audit.modifiedBy}">Zmodyfikowane przez</th>
                <th th:text="#{table.actions}">Akcje</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="g : ${gympasses}">
                <td th:text="${g.id}">1</td>
                <td th:text="${g.ownerName}">Jan Kowalski</td>
                <td th:text="${g.passType}">Miesięczny</td>
                <td>
                        <span class="badge"
                              th:classappend="${g.active} ? 'bg-success' : 'bg-danger'"
                              th:text="${g.active} ? 'Tak' : 'Nie'">
                            Tak
                        </span>
                </td>
                <td th:text="${g.startDate != null ? #temporals.format(g.startDate, 'dd-MM-yyyy') : '-'}">01-01-2024</td>
                <td th:text="${g.endDate != null ? #temporals.format(g.endDate, 'dd-MM-yyyy') : '-'}">31-01-2024</td>
                <td th:text="${g.entriesLeft}">10</td>
                <td th:text="${g.price != null ? #numbers.formatDecimal(g.price, 1, 2) + ' PLN' : '-'}">199.99 PLN</td>
                <td class="text-muted small" th:text="${g.createdBy ?: '-'}">system</td>
                <td class="text-muted small" th:text="${g.modifiedBy ?: '-'}">admin</td>
                <td>
                    <div class="btn-group btn-group-sm" role="group">
                        <a sec:authorize="hasRole('ADMIN')"
                           th:href="@{/form(id=${g.id})}"
                           class="btn btn-outline-primary"
                           th:text="#{action.edit}">
                            Edytuj
                        </a>
                        <a sec:authorize="hasRole('ADMIN')"
                           th:href="@{/delete(id=${g.id})}"
                           class="btn btn-outline-danger"
                           th:onclick="'return confirm(\'' + #{action.confirm.delete} + '\');'"
                           th:text="#{action.delete}">
                            Usuń
                        </a>
                        <a sec:authorize="hasAnyRole('MEMBER','STAFF','ADMIN')"
                           th:href="@{/details/{id}(id=${g.id})}"
                           class="btn btn-outline-info"
                           th:text="#{action.details}">
                            Szczegóły
                        </a>
                    </div>
                </td>
            </tr>
            </tbody>
        </table>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>